<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="ai_adoption_portfolio.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="1069"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><table title="ai_adoption" custom_title="0" dock_id="1" table="4,11:mainai_adoption"/><dock_state state="000000ff00000000fd0000000100000002000001c30000021ffc0100000001fb000000160064006f0063006b00420072006f00770073006500310100000000000001c30000010100ffffff000001c30000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="ai_adoption" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="71"/><column index="2" value="85"/><column index="3" value="87"/><column index="5" value="129"/><column index="6" value="37"/><column index="7" value="300"/><column index="8" value="78"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1">-- 1. 各AI工具的整体采用率对比（展示聚合函数）
SELECT 
    ai_tool,
    COUNT(*) as usage_count,
    ROUND(AVG(adoption_rate), 2) as avg_adoption_rate,
    SUM(daily_active_users) as total_active_users
FROM ai_adoption
GROUP BY ai_tool
ORDER BY avg_adoption_rate DESC;

-- 2. 各行业AI采用趋势（2023 vs 2024）
WITH yearly_stats AS (
    SELECT 
        industry,
        year,
        ROUND(AVG(adoption_rate), 2) as avg_rate,
        LAG(ROUND(AVG(adoption_rate), 2)) OVER (PARTITION BY industry ORDER BY year) as prev_year_rate
    FROM ai_adoption
    GROUP BY industry, year
)
SELECT 
    industry,
    year,
    avg_rate,
    prev_year_rate,
    ROUND((avg_rate - COALESCE(prev_year_rate, 0)) / COALESCE(prev_year_rate, 1) * 100, 2) as growth_percentage
FROM yearly_stats
ORDER BY growth_percentage DESC;

-- 3. 不同公司规模对AI工具偏好分析
SELECT 
    company_size,
    ai_tool,
    COUNT(*) as count,
    ROUND(AVG(adoption_rate), 2) as avg_adoption,
    ROUND(AVG(daily_active_users), 0) as avg_daily_users,
    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY company_size), 2) as tool_percentage
FROM ai_adoption
GROUP BY company_size, ai_tool
ORDER BY company_size, avg_adoption DESC;

-- 4. 区域AI成熟度分析
SELECT 
    CASE 
        WHEN country IN ('USA', 'Canada') THEN '北美'
        WHEN country IN ('UK', 'France', 'Germany') THEN '欧洲'
        WHEN country IN ('China', 'South Korea', 'India') THEN '亚洲'
        WHEN country IN ('Australia') THEN '大洋洲'
        WHEN country IN ('Brazil') THEN '南美'
        ELSE '其他'
    END as region,
    COUNT(*) as total_records,
    ROUND(AVG(adoption_rate), 2) as avg_adoption,
    SUM(daily_active_users) as total_users,
    COUNT(DISTINCT ai_tool) as tools_used
FROM ai_adoption
GROUP BY region
ORDER BY avg_adoption DESC;

-- 5. 识别高增长潜力行业
SELECT 
    industry,
    ai_tool,
    adoption_rate,
    daily_active_users,
    ROUND(
        adoption_rate * daily_active_users * 1.0 / 
        (SUM(adoption_rate * daily_active_users) OVER (PARTITION BY industry) + 0.001),
        4
    ) as industry_share
FROM ai_adoption
WHERE year = 2024
QUALIFY ROW_NUMBER() OVER (PARTITION BY industry ORDER BY adoption_rate DESC) &lt;= 3
ORDER BY industry, adoption_rate DESC;</sql><current_tab id="0"/></tab_sql></sqlb_project>
